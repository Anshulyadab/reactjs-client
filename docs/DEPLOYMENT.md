# Deployment Guide: PostgreSQL React App to Vercel + Neon

This guide will help you deploy your PostgreSQL React app to Vercel with Neon as the database provider.

## 🚀 Quick Deployment Steps

### Option A: GitHub Actions (Recommended)

1. **Set up GitHub repository and push code**
2. **Configure GitHub Secrets** (see [GITHUB_ACTIONS_SETUP.md](GITHUB_ACTIONS_SETUP.md))
3. **Automatic deployment** on every push to main branch

### Option B: Manual Deployment

### 1. Set up Neon Database

1. **Create a Neon Account**
   - Go to [neon.tech](https://neon.tech)
   - Sign up for a free account
   - Create a new project

2. **Get Your Connection String**
   - In your Neon dashboard, go to "Connection Details"
   - Copy the connection string (it will look like: `postgresql://username:password@ep-xxx.us-east-1.aws.neon.tech/neondb?sslmode=require`)

### 2. Deploy to Vercel

#### Option A: Deploy via Vercel CLI (Recommended)

1. **Install Vercel CLI**
   ```bash
   npm i -g vercel
   ```

2. **Login to Vercel**
   ```bash
   vercel login
   ```

3. **Deploy**
   ```bash
   vercel
   ```

4. **Set Environment Variables**
   ```bash
   vercel env add NEON_DATABASE_URL
   # Paste your Neon connection string when prompted
   ```

5. **Redeploy with Environment Variables**
   ```bash
   vercel --prod
   ```

#### Option B: Deploy via Vercel Dashboard

1. **Push to GitHub**
   - Create a GitHub repository
   - Push your code to GitHub

2. **Connect to Vercel**
   - Go to [vercel.com](https://vercel.com)
   - Sign up/login with GitHub
   - Click "New Project"
   - Import your GitHub repository

3. **Configure Environment Variables**
   - In your Vercel project dashboard
   - Go to "Settings" → "Environment Variables"
   - Add: `NEON_DATABASE_URL` with your Neon connection string

4. **Deploy**
   - Click "Deploy" button
   - Vercel will automatically build and deploy your app

## 🔧 Environment Variables

### Required Environment Variables

| Variable | Description | Example |
|----------|-------------|---------|
| `NEON_DATABASE_URL` | Neon database connection string | `postgresql://user:pass@ep-xxx.us-east-1.aws.neon.tech/neondb?sslmode=require` |

### Optional Environment Variables

| Variable | Description | Default |
|----------|-------------|---------|
| `NODE_ENV` | Environment mode | `production` (on Vercel) |
| `PORT` | Server port | `5000` (local), auto (Vercel) |

## 📁 Project Structure for Deployment

```
postgres-react-app/
├── client/                 # React frontend
│   ├── src/
│   ├── public/
│   ├── package.json
│   └── build/              # Generated by npm run build
├── server.js               # Express backend
├── package.json            # Backend dependencies
├── vercel.json             # Vercel configuration
├── .vercelignore           # Files to ignore in deployment
└── DEPLOYMENT.md           # This file
```

## 🛠️ Build Process

Vercel will automatically:

1. **Install Dependencies**
   ```bash
   npm install
   cd client && npm install
   ```

2. **Build React App**
   ```bash
   npm run build
   ```

3. **Deploy**
   - Backend API routes: `/api/*`
   - Frontend: All other routes
   - Static files served from `client/build/`

## 🔍 Testing Your Deployment

After deployment, test these endpoints:

1. **Health Check**: `https://your-app.vercel.app/api/health`
2. **Database Test**: `https://your-app.vercel.app/api/test-db`
3. **Frontend**: `https://your-app.vercel.app/`

## 🐛 Troubleshooting

### Common Issues

1. **Database Connection Failed**
   - Check your `NEON_DATABASE_URL` environment variable
   - Ensure SSL is enabled (`sslmode=require`)
   - Verify your Neon database is active

2. **Build Failed**
   - Check that all dependencies are in `package.json`
   - Ensure React build completes successfully
   - Check Vercel build logs for specific errors

3. **API Routes Not Working**
   - Verify `vercel.json` configuration
   - Check that routes are properly defined
   - Ensure server.js exports the app

### Debug Commands

```bash
# Test locally with production build
npm run build
npm start

# Check Vercel deployment logs
vercel logs

# Test environment variables
vercel env ls
```

## 🔄 Updating Your Deployment

### With GitHub Actions (Automatic)
1. **Make changes to your code**
2. **Commit and push to GitHub**
3. **Deployment happens automatically**

### Manual Updates
1. **Make changes to your code**
2. **Commit and push to GitHub** (if using GitHub integration)
3. **Or redeploy with Vercel CLI**:
   ```bash
   vercel --prod
   ```

## 🤖 GitHub Actions Setup

For automatic deployment with GitHub Actions:

1. **Follow the detailed guide**: [GITHUB_ACTIONS_SETUP.md](GITHUB_ACTIONS_SETUP.md)
2. **Configure GitHub Secrets**:
   - `VERCEL_TOKEN`
   - `VERCEL_ORG_ID`
   - `VERCEL_PROJECT_ID`
   - `NEON_DATABASE_URL`
3. **Push to main branch** → Automatic deployment
4. **Create PR** → Preview deployment

### Benefits of GitHub Actions:
- ✅ **Automatic deployment** on code changes
- ✅ **Preview deployments** for pull requests
- ✅ **Build validation** before deployment
- ✅ **Deployment status** in GitHub
- ✅ **Rollback capabilities** through Vercel dashboard

## 📊 Monitoring

- **Vercel Dashboard**: Monitor deployments, performance, and errors
- **Neon Dashboard**: Monitor database usage, connections, and performance
- **Application Logs**: Available in Vercel dashboard under "Functions"

## 🎯 Production Checklist

- [ ] Neon database created and connection string obtained
- [ ] Environment variables set in Vercel
- [ ] React app builds successfully (`npm run build`)
- [ ] API endpoints respond correctly
- [ ] Database connection works in production
- [ ] Frontend loads and functions properly
- [ ] SSL/HTTPS working (automatic with Vercel)

## 🆘 Support

- **Vercel Documentation**: [vercel.com/docs](https://vercel.com/docs)
- **Neon Documentation**: [neon.tech/docs](https://neon.tech/docs)
- **PostgreSQL Documentation**: [postgresql.org/docs](https://postgresql.org/docs)

## 🎉 Success!

Once deployed, your PostgreSQL React app will be available at:
`https://your-app-name.vercel.app`

The app includes:
- ✅ Full-stack React + Express application
- ✅ PostgreSQL database with Neon
- ✅ Real-time database testing interface
- ✅ SQL query execution
- ✅ Database schema inspection
- ✅ Connection diagnostics
- ✅ Responsive design
- ✅ Production-ready deployment
